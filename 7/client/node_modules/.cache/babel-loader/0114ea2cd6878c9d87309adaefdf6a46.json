{"ast":null,"code":"import _regeneratorRuntime from \"C:\\\\\\u041F\\u0440\\u043E\\u0433\\u0440\\u0430\\u043C\\u043C\\u0438\\u0440\\u043E\\u0432\\u0430\\u043D\\u0438\\u0435\\\\node\\\\7\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";\nimport _asyncToGenerator from \"C:\\\\\\u041F\\u0440\\u043E\\u0433\\u0440\\u0430\\u043C\\u043C\\u0438\\u0440\\u043E\\u0432\\u0430\\u043D\\u0438\\u0435\\\\node\\\\7\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"C:\\\\\\u041F\\u0440\\u043E\\u0433\\u0440\\u0430\\u043C\\u043C\\u0438\\u0440\\u043E\\u0432\\u0430\\u043D\\u0438\\u0435\\\\node\\\\7\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport axios from 'axios';\nimport { call, put, takeEvery, all, select } from 'redux-saga/effects';\nimport { accessTokenSelector } from '../../ducks/auth';\nimport { apiUrl as baseURL } from '../../config';\n\nvar Api = function Api() {\n  _classCallCheck(this, Api);\n};\n\nApi.Get = function (url, data, options) {\n  return Api.Request(url, 'GET', data, options);\n};\n\nApi.Post = function (url, data, options) {\n  return Api.Request(url, 'POST', data, options);\n};\n\nApi.Request = function (url, method, data, config) {\n  config = config || {};\n  return new Promise(\n  /*#__PURE__*/\n  function () {\n    var _ref = _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee(resolve, reject) {\n      var _ref2, result;\n\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n              debugger;\n              _context.next = 4;\n              return axios({\n                method: method,\n                baseURL: baseURL,\n                url: url,\n                data: data,\n                headers: config.headers\n              });\n\n            case 4:\n              _ref2 = _context.sent;\n              result = _ref2.data;\n              resolve(result);\n              _context.next = 12;\n              break;\n\n            case 9:\n              _context.prev = 9;\n              _context.t0 = _context[\"catch\"](0);\n              resolve({\n                error: _context.t0\n              });\n\n            case 12:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[0, 9]]);\n    }));\n\n    return function (_x, _x2) {\n      return _ref.apply(this, arguments);\n    };\n  }());\n};\n\nApi.GetSaga =\n/*#__PURE__*/\n_regeneratorRuntime.mark(function _callee2(url, data, needAuthorization) {\n  var config, token;\n  return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n    while (1) {\n      switch (_context2.prev = _context2.next) {\n        case 0:\n          debugger;\n          config = {};\n\n          if (!needAuthorization) {\n            _context2.next = 8;\n            break;\n          }\n\n          _context2.next = 5;\n          return select(accessTokenSelector);\n\n        case 5:\n          token = _context2.sent;\n\n          if (!config.headers) {\n            config.headers = {};\n          }\n\n          config.headers.Authorization = \"Bearer \".concat(token);\n\n        case 8:\n          _context2.next = 10;\n          return call(Api.Get, url, data, config);\n\n        case 10:\n          return _context2.abrupt(\"return\", _context2.sent);\n\n        case 11:\n        case \"end\":\n          return _context2.stop();\n      }\n    }\n  }, _callee2);\n});\nexport { Api as default };","map":{"version":3,"sources":["C:/Программирование/node/7/client/src/helpers/api/index.js"],"names":["axios","call","put","takeEvery","all","select","accessTokenSelector","apiUrl","baseURL","Api","Get","url","data","options","Request","Post","method","config","Promise","resolve","reject","headers","result","error","GetSaga","needAuthorization","token","Authorization"],"mappings":";;;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,SAASC,IAAT,EAAeC,GAAf,EAAoBC,SAApB,EAA+BC,GAA/B,EAAoCC,MAApC,QAAkD,oBAAlD;AAEA,SAASC,mBAAT,QAAoC,kBAApC;AACA,SAASC,MAAM,IAAIC,OAAnB,QAAkC,cAAlC;;IAEqBC,G;;;;AAAAA,G,CAEVC,G,GAAM,UAACC,GAAD,EAAMC,IAAN,EAAYC,OAAZ,EAAwB;AACjC,SAAOJ,GAAG,CAACK,OAAJ,CAAYH,GAAZ,EAAiB,KAAjB,EAAwBC,IAAxB,EAA8BC,OAA9B,CAAP;AACH,C;;AAJgBJ,G,CAMVM,I,GAAO,UAACJ,GAAD,EAAMC,IAAN,EAAYC,OAAZ,EAAwB;AAClC,SAAOJ,GAAG,CAACK,OAAJ,CAAYH,GAAZ,EAAiB,MAAjB,EAAyBC,IAAzB,EAA+BC,OAA/B,CAAP;AACH,C;;AARgBJ,G,CAUVK,O,GAAU,UAACH,GAAD,EAAMK,MAAN,EAAcJ,IAAd,EAAoBK,MAApB,EAA+B;AAE5CA,EAAAA,MAAM,GAAGA,MAAM,IAAI,EAAnB;AAEA,SAAO,IAAIC,OAAJ;AAAA;AAAA;AAAA;AAAA;AAAA,6BAAY,iBAAOC,OAAP,EAAgBC,MAAhB;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAGX;AAHW;AAAA,qBAIoBpB,KAAK,CAAC;AAAEgB,gBAAAA,MAAM,EAANA,MAAF;AAAUR,gBAAAA,OAAO,EAAPA,OAAV;AAAmBG,gBAAAA,GAAG,EAAHA,GAAnB;AAAwBC,gBAAAA,IAAI,EAAJA,IAAxB;AAA8BS,gBAAAA,OAAO,EAAEJ,MAAM,CAACI;AAA9C,eAAD,CAJzB;;AAAA;AAAA;AAIGC,cAAAA,MAJH,SAIHV,IAJG;AAMXO,cAAAA,OAAO,CAACG,MAAD,CAAP;AANW;AAAA;;AAAA;AAAA;AAAA;AASXH,cAAAA,OAAO,CAAC;AAACI,gBAAAA,KAAK;AAAN,eAAD,CAAP;;AATW;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAZ;;AAAA;AAAA;AAAA;AAAA,MAAP;AAYH,C;;AA1BgBd,G,CA4BVe,O;;yBAAU,kBAAWb,GAAX,EAAgBC,IAAhB,EAAsBa,iBAAtB;AAAA;AAAA;AAAA;AAAA;AAAA;AACb;AACIR,UAAAA,MAFS,GAEA,EAFA;;AAAA,eAIVQ,iBAJU;AAAA;AAAA;AAAA;;AAAA;AAKK,iBAAMpB,MAAM,CAACC,mBAAD,CAAZ;;AALL;AAKHoB,UAAAA,KALG;;AAOT,cAAG,CAACT,MAAM,CAACI,OAAX,EAAoB;AAChBJ,YAAAA,MAAM,CAACI,OAAP,GAAiB,EAAjB;AACH;;AAEDJ,UAAAA,MAAM,CAACI,OAAP,CAAeM,aAAf,oBAAyCD,KAAzC;;AAXS;AAAA;AAcN,iBAAMzB,IAAI,CAACQ,GAAG,CAACC,GAAL,EAAUC,GAAV,EAAeC,IAAf,EAAqBK,MAArB,CAAV;;AAdM;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,C;SA5BAR,G","sourcesContent":["import axios from 'axios'\r\nimport { call, put, takeEvery, all, select } from 'redux-saga/effects'\r\n\r\nimport { accessTokenSelector } from '../../ducks/auth'\r\nimport { apiUrl as baseURL } from '../../config'\r\n\r\nexport default class Api {\r\n\r\n    static Get = (url, data, options) => {\r\n        return Api.Request(url, 'GET', data, options)\r\n    }\r\n\r\n    static Post = (url, data, options) => {\r\n        return Api.Request(url, 'POST', data, options)\r\n    }\r\n\r\n    static Request = (url, method, data, config) => {\r\n\r\n        config = config || {}\r\n        \r\n        return new Promise(async (resolve, reject) => {\r\n\r\n            try {\r\n                debugger\r\n                const { data: result } = await axios({ method, baseURL, url, data, headers: config.headers })\r\n\r\n                resolve(result)\r\n            }\r\n            catch(error) {\r\n                resolve({error})\r\n            }\r\n        });\r\n    }\r\n\r\n    static GetSaga = function* (url, data, needAuthorization) {\r\n        debugger\r\n        let config = {}\r\n\r\n        if(needAuthorization) {\r\n            const token = yield select(accessTokenSelector)\r\n\r\n            if(!config.headers) {\r\n                config.headers = {}\r\n            }\r\n\r\n            config.headers.Authorization = `Bearer ${token}`;\r\n        }\r\n\r\n        return yield call(Api.Get, url, data, config)\r\n    }\r\n\r\n}"]},"metadata":{},"sourceType":"module"}